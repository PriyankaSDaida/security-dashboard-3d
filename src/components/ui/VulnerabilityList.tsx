import {
    Box, Paper, Typography,
    Table, TableBody, TableCell, TableContainer, TableHead, TableRow
} from '@mui/material';

import { useTheme } from '@mui/material/styles';
import { useStore } from '../../store';



const rows = [
    { id: 'cve-1', severity: 'Critical', description: 'CVE-2024-1234: Remote Code Execution', status: 'Open', assigned: 'Security Team A' },
    { id: 'sql-1', severity: 'High', description: 'SQL Injection in Login', status: 'In Progress', assigned: 'DevOps' },
    { id: 'auth-1', severity: 'High', description: 'Brute Force Anomaly', status: 'Analysis', assigned: 'SOC' },
    { id: 'xss-2', severity: 'Medium', description: 'Reflected XSS on Search', status: 'Open', assigned: 'Frontend' },
    { id: 'dep-3', severity: 'Low', description: 'Outdated Dependency: lodash', status: 'Patching', assigned: 'Bot' },
];

export const VulnerabilityList = () => {
    const theme = useTheme();
    const { selectedThreat, setSelectedThreat } = useStore();

    return (
        <Paper sx={{
            height: '100%',
            width: '100%',
            background: 'rgba(5, 10, 20, 0.8)', // Darker background for readability
            borderTop: `2px solid ${theme.palette.primary.main}`,
            display: 'flex',
            flexDirection: 'column',
            overflow: 'hidden'
        }}>
            <Box sx={{ p: 2, borderBottom: '1px solid rgba(255,255,255,0.1)' }}>
                <Typography variant="h6" color="primary">Active Vulnerabilities</Typography>
            </Box>
            <Box sx={{ flex: 1, overflow: 'auto' }}>
                <TableContainer>
                    <Table stickyHeader size="small">
                        <TableHead>
                            <TableRow>
                                <TableCell sx={{ bgcolor: 'rgba(0, 240, 255, 0.1)', color: 'primary.main', fontWeight: 'bold' }}>ID</TableCell>
                                <TableCell sx={{ bgcolor: 'rgba(0, 240, 255, 0.1)', color: 'primary.main', fontWeight: 'bold' }}>Severity</TableCell>
                                <TableCell sx={{ bgcolor: 'rgba(0, 240, 255, 0.1)', color: 'primary.main', fontWeight: 'bold' }}>Vulnerability</TableCell>
                                <TableCell sx={{ bgcolor: 'rgba(0, 240, 255, 0.1)', color: 'primary.main', fontWeight: 'bold' }}>Status</TableCell>
                                <TableCell sx={{ bgcolor: 'rgba(0, 240, 255, 0.1)', color: 'primary.main', fontWeight: 'bold' }}>Owner</TableCell>
                            </TableRow>
                        </TableHead>
                        <TableBody>
                            {rows.map((row) => (
                                <TableRow
                                    key={row.id}
                                    onClick={() => setSelectedThreat(row.id)}
                                    selected={selectedThreat === row.id}
                                    hover
                                    sx={{
                                        cursor: 'pointer',
                                        '&.Mui-selected': {
                                            backgroundColor: `${theme.palette.secondary.main}20 !important`,
                                        },
                                        '&:hover': {
                                            backgroundColor: `${theme.palette.secondary.main}10 !important`,
                                        }
                                    }}
                                >
                                    <TableCell sx={{ color: 'text.secondary' }}>{row.id}</TableCell>
                                    <TableCell>
                                        <Box sx={{
                                            color: row.severity === 'Critical' ? '#FF003C' : '#FFEA00',
                                            fontWeight: 'bold'
                                        }}>
                                            {row.severity}
                                        </Box>
                                    </TableCell>
                                    <TableCell sx={{ color: 'text.primary' }}>{row.description}</TableCell>
                                    <TableCell sx={{ color: 'text.secondary' }}>{row.status}</TableCell>
                                    <TableCell sx={{ color: 'text.secondary' }}>{row.assigned}</TableCell>
                                </TableRow>
                            ))}
                        </TableBody>
                    </Table>
                </TableContainer>
            </Box>
        </Paper>
    );
};
